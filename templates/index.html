<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disk Extractor - Movie Metadata Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="header">
        <h1>Disk Extractor - Movie Metadata Manager</h1>
        <p>Directory: {{ directory }}</p>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <ul class="file-list" id="fileList">
                {% for movie in movies %}
                <li class="file-item {% if movie.has_metadata %}has-metadata{% else %}no-metadata{% endif %}" 
                    data-filename="{{ movie.file_name }}"
                    onclick="selectFile('{{ movie.file_name }}')">
                    <div class="file-name">
                        <span class="status-indicator {% if movie.has_metadata %}has-metadata{% else %}no-metadata{% endif %}"></span>
                        {{ movie.file_name }}
                    </div>
                    <div class="file-info">
                        {% if movie.size_mb %}{{ movie.size_mb }} MB{% endif %}
                        {% if movie.has_metadata %} ‚Ä¢ Has metadata{% else %} ‚Ä¢ No metadata{% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>
        
        <div class="resizer" id="resizer"></div>
        
        <div class="main-content">
            <div id="emptyState" class="empty-state">
                <h2>Select a movie file to begin</h2>
                <p>Choose a file from the list on the left to view and edit its metadata.</p>
            </div>
            
            <div id="metadataForm" style="display: none;">
                <div class="file-info-section">
                    <h2 id="currentFileName">No file selected</h2>
                    <div class="file-actions-row">
                        <div class="file-size">
                            <span id="currentFileSize"></span>
                        </div>
                        <div class="action-buttons">
                            <button type="button" id="scanButton" onclick="scanFile()" class="action-button scan-button">
                                üîç Scan Media
                            </button>
                            <button type="button" id="rawOutputButton" onclick="showRawOutput()" class="action-button raw-output-button" style="display: none;">
                                üìÑ Raw Output
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="enhancedMetadata" class="enhanced-metadata">
                    <div id="scanError" class="scan-error" style="display: none;">
                        <h3>‚ö†Ô∏è HandBrake Scan Error</h3>
                        <p id="scanErrorMessage"></p>
                        <button type="button" onclick="scanFile()" class="action-button scan-button">üîÑ Retry Scan</button>
                    </div>
                    
                    <div class="titles-container" id="titlesContainer">
                        <!-- Titles will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Raw Output Modal -->
    <div id="rawOutputModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>HandBrake Raw Output</h2>
                <span class="close" onclick="closeRawOutputModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="rawOutputContent">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        // Initialize the app with movie data
        initializeApp({{ movies | tojson }});
    </script>
</body>
</html>
